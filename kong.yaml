_format_version: "3.0"

services:
  - name: auth-service
    url: http://account:3001/auth
    routes:
      - name: auth-routes
        paths:
          - /auth

  - name: user-service
    url: http://account:3001/users
    routes:
      - name: user-routes
        paths:
          - /users

plugins:
  - name: rate-limiting
    config:
      minute: 5
      policy: local
      error_message: "API rate limit exceeded. Try again in a minute."
#  - name: jwt
#    config:
#      key_claim_name: "sub"
#      secret: "${KONG_JWT_SECRET}"
#      secret_is_base64: false
#
#
#routes:
#  - name: jwt-auth-route
#    paths:
#      - /secure-endpoint
#    plugins:
#      - name: jwt
#        run_on: first